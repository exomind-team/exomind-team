{
	"nodes":[
		{"id":"1ce272067a1852d1","type":"text","text":"### 立创K230开发板\n购买[链接](https://item.szlcsc.com/43107323.html)\n![image.png](http://qingniu.oos.hailay.site/202412281942852.png)\n","x":-387,"y":-183,"width":427,"height":703,"color":"1"},
		{"id":"254cd390f67dfb4f","type":"text","text":"安装散热","x":240,"y":-20,"width":250,"height":60,"color":"1"},
		{"id":"9f81072edabab14d","type":"text","text":"安装外壳","x":240,"y":109,"width":250,"height":60,"color":"4"},
		{"id":"294c184c4cc4b1fa","type":"text","text":"安装摄像头","x":240,"y":260,"width":250,"height":60,"color":"4"},
		{"id":"96f761af5e879393","type":"text","text":"烧录系统","x":660,"y":-160,"width":250,"height":60,"color":"4"},
		{"id":"eaea6a58bb73ece4","type":"text","text":"进入系统","x":1080,"y":-160,"width":250,"height":60,"color":"4"},
		{"id":"4edcc122ec069de9","type":"text","text":"寻找资料\n[论坛](https://developer.canaan-creative.com/answer/)","x":660,"y":-50,"width":250,"height":60,"color":"4"},
		{"id":"d14563b3a4636ec1","type":"text","text":"寻找SD卡","x":660,"y":79,"width":250,"height":60,"color":"4"},
		{"id":"b0bf1655232a923d","type":"text","text":"SD卡烧录软件\nRufus\n![image.png](http://qingniu.oos.hailay.site/202412282030885.png)\n","x":653,"y":220,"width":265,"height":380},
		{"id":"223b7e9ddeb5cd15","type":"text","text":"### [双系统SDK](https://github.com/kendryte/k230_sdk)\n\n双系统[教程](https://developer.canaan-creative.com/k230/zh/dev/01_software/board/K230_SDK_%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E.html)\n资料很丰富","x":785,"y":-500,"width":334,"height":175},
		{"id":"2314fc00e5872dc8","type":"file","file":"99-Meta/附件存储/appendix/cee49715351f6dd3496baf19af1262ed.png","x":660,"y":-980,"width":584,"height":357},
		{"id":"b3d8ffdb2b066cad","type":"link","url":"https://developer.canaan-creative.com/k230_canmv/main/zh/example/index.html","x":-999,"y":720,"width":400,"height":400},
		{"id":"44f8bfe17ee31fe4","type":"link","url":"https://github.com/kendryte/k230_sdk","x":-999,"y":1160,"width":400,"height":400},
		{"id":"75be3a51763935f5","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250106222915.jpg","x":240,"y":800,"width":413,"height":519},
		{"id":"22890a3ebcd3e1fb","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250106223009.png","x":240,"y":1440,"width":480,"height":208},
		{"id":"3eda1fd682115d10","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250106223043.png","x":718,"y":940,"width":400,"height":265},
		{"id":"bfe9538c7cb0b32f","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250109195220.png","x":0,"y":1760,"width":819,"height":577},
		{"id":"e2b9ce70e24a9d14","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250109195423.png","x":0,"y":2480,"width":840,"height":594},
		{"id":"7a2f125fe4720aa9","type":"text","text":"搞了最新的固件[CanMV-K230_LCKFB_micropython_PreRelease_nncase_v2.9.0.img.gz](https://github.com/kendryte/canmv_k230/releases/download/PreRelease/CanMV-K230_LCKFB_micropython_PreRelease_nncase_v2.9.0.img.gz)","x":653,"y":660,"width":327,"height":140},
		{"id":"b3e0e1b8ff43007c","type":"text","text":"看在眼里的、注意到的范围不同，只关注其中某些方面","x":1270,"y":1317,"width":230,"height":123},
		{"id":"1e3124287a809dc4","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250111133104.png","x":1180,"y":500,"width":440,"height":449},
		{"id":"68ac3a73800fcc1f","type":"text","text":"![](http://qingniu.oos.hailay.site/202412281946396.png)","x":-860,"y":-183,"width":338,"height":283},
		{"id":"5255259660570bc8","type":"text","text":"硬件初始化","x":240,"y":-160,"width":250,"height":60,"color":"4"},
		{"id":"ee30dc310284920d","type":"text","text":"资料","x":-525,"y":637,"width":250,"height":60,"color":"1"},
		{"id":"e3dee4008797092d","type":"text","text":"### 嘉立创官方资料\nhttps://wiki.lckfb.com/zh-hans/lushan-pi-k230/quick-start.html","x":-999,"y":442,"width":278,"height":157,"color":"4"},
		{"id":"5958c3831f68a399","type":"text","text":"劳动记录\n\n耗时1-1.5h","x":-49,"y":-475,"width":289,"height":115,"color":"5"},
		{"id":"40e9b4438085ad87","type":"link","url":"https://github.com/kendryte/k230_docs/?tab=readme-ov-file","x":-373,"y":920,"width":400,"height":400},
		{"id":"2090fb86a7d04361","type":"text","text":"### [Linux系统SDK教程](https://developer.canaan-creative.com/k230_linux/dev/index.html)\n\n[Linux SDK GitHub源码](https://github.com/kendryte/k230_linux_sdk)","x":400,"y":-475,"width":295,"height":125},
		{"id":"a457d7bdfbea1ae0","type":"link","url":"https://oshwhub.com/li-chuang-kai-fa-ban/li-chuang-lu-shan-pai-k230-canmv-kai-fa-ban","x":-1340,"y":-140,"width":400,"height":400},
		{"id":"47a53674fcb7fb3a","type":"file","file":"99-Meta/附件存储/appendix/uart_20241025_150330.svg","x":-1480,"y":591,"width":398,"height":92},
		{"id":"aa26482d0a8d5761","type":"text","text":"openmv","x":2635,"y":1560,"width":140,"height":60,"color":"1"},
		{"id":"7ce747c1fb6fa5d6","type":"text","text":"k230 risc-v64","x":2909,"y":1670,"width":250,"height":60},
		{"id":"b8e73d75ba1dd1e4","type":"text","text":"canmv","x":2964,"y":1559,"width":140,"height":61,"color":"1"},
		{"id":"191b78514af1385b","type":"text","text":"stm32h7","x":2580,"y":1670,"width":250,"height":60},
		{"id":"1304bd533742b211","type":"text","text":"openmv vscode","x":2580,"y":1420,"width":250,"height":60},
		{"id":"0fc80c4b3f0704d4","type":"text","text":"micropython","x":2574,"y":1824,"width":250,"height":60,"color":"1"},
		{"id":"957c28c3f2df157e","type":"text","text":"### uos\nsync()没有实现","x":2980,"y":220,"width":200,"height":100,"color":"2"},
		{"id":"c9e78b813c3ae603","type":"text","text":"### vfs\n压根没实现","x":2955,"y":400,"width":250,"height":100,"color":"1"},
		{"id":"471f55b6b6915dfb","type":"text","text":"### network\nWi-Fi STA测试成功","x":3280,"y":220,"width":240,"height":90,"color":"4"},
		{"id":"434f1ad1856d3e88","type":"text","text":"### ucryptolib\n没有``/dev/sm4``、``/dev/aes``，测试失败","x":3485,"y":730,"width":200,"height":220,"color":"1"},
		{"id":"993bf5ab54f62041","type":"text","text":"### [gc](https://github.com/kendryte/k230_canmv_docs/blob/main/zh/api/stdlib/gc.md)\n添加``sys_heap``、page、mmz(多媒体内存)函数","x":3610,"y":215,"width":246,"height":174,"color":"4"},
		{"id":"13472bf27e21b30e","type":"text","text":"发现micropython固件的内存分配小，只有**4MB**，需要改固件","x":3610,"y":450,"width":247,"height":112,"color":"6"},
		{"id":"837c233943634cee","type":"text","text":"### utime\nok","x":3270,"y":404,"width":250,"height":102,"color":"4"},
		{"id":"a8cfe1d7980ed1d7","type":"text","text":"### globals()\n全局变量dict","x":3930,"y":231,"width":270,"height":129,"color":"4"},
		{"id":"dc63c095ded2423e","type":"text","text":"### _thread\n能用，但控制台不能停止while(1)的多线程程序运行","x":3963,"y":472,"width":237,"height":178,"color":"5"},
		{"id":"1a509558926c7876","type":"text","text":"### yield\n还不知道这个能干吗，似乎是多任务系统","x":3957,"y":757,"width":250,"height":166,"color":"5"},
		{"id":"3dc46e5f4e088811","type":"text","text":"加密与哈希","x":3285,"y":620,"width":250,"height":60,"color":"1"},
		{"id":"e7bf78d3eef9e730","type":"text","text":"### timer\n硬件定时器 [0-5] 暂不可用。没有``/dev/timer``，只能用软件定时器``-1``，时间间隔为``1ms``。\n\n``OSError: Timer 1 busy``尝试用timer1则输出","x":2900,"y":-220,"width":305,"height":300,"color":"1"},
		{"id":"22bf0cfe76794279","type":"text","text":"模块测试","x":3295,"y":20,"width":250,"height":60,"color":"1"},
		{"id":"956f14e606cc00ec","type":"text","text":"### `machine`\n硬重启 ``machine.reset()``用完，VSCode IDE micropico的run、stop按钮会变成stop且关闭不了，必须重启VSCode。而且**软重启**没用。","x":3270,"y":-272,"width":330,"height":230},
		{"id":"ae88f9b97b7137bb","type":"text","text":"### uhashlib\n没有``/dev/hwhash``设备，固件没编译","x":3100,"y":730,"width":241,"height":159,"color":"1"},
		{"id":"c66c924ac45724b7","type":"text","text":"编程demo","x":1755,"y":-220,"width":245,"height":60,"color":"4"},
		{"id":"e56cdf8fcd04ef2f","type":"text","text":"### 评价\n\n顺利得难以置信","x":2179,"y":-214,"width":261,"height":114,"color":"4"},
		{"id":"e6c7322af0e108ce","type":"text","text":"编程语言：MicroPython","x":1717,"y":-480,"width":327,"height":87,"color":"2"},
		{"id":"17f57eee25a72bcf","type":"text","text":"## 编辑器问题\n1. 不支持除了K230 Canmv IDE之外的编辑器，例如VSCode，[目前官方无规划出VSCode插件的计划](https://developer.canaan-creative.com/answer/questions/10010000000000745)\n2. [canmv IDE软件不响应](https://github.com/kendryte/canmv_ide/issues/1)，可用管理员权限打开缓解","x":1756,"y":552,"width":304,"height":468},
		{"id":"841905462af69e85","type":"text","text":"[用户也可以选择使用 OpenMV IDE，但是 OpenMV IDE 只能连接 K230，不能连接 K210](https://developer.canaan-creative.com/k230_canmv/main/zh/userguide/how_to_use_ide.html)，使用 4.0 以上版本的 OpenMV IDE 连接可以获得更高的图像显示帧率。","x":2107,"y":608,"width":406,"height":178},
		{"id":"3459d7d1a4b740ad","type":"link","url":"https://docs.singtown.com/micropython/zh/latest/esp32/library/micropython.html","x":1681,"y":-1060,"width":400,"height":400},
		{"id":"544a36003d9a2aad","type":"link","url":"https://github.com/paulober/MicroPico?tab=readme-ov-file","x":2107,"y":920,"width":400,"height":400},
		{"id":"3186af67ed5d89f3","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20241228203442.png","x":1300,"y":-20,"width":519,"height":385},
		{"id":"52c6a6565f647fa7","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20241228211241.png","x":1880,"y":-2,"width":660,"height":433},
		{"id":"cee0f2f679d74b20","type":"text","text":"其中**UART0**被小核sh占用，**UART3被大核**sh占用，剩余UART1，UART2，UART4可供用户使用","x":240,"y":1340,"width":498,"height":80},
		{"id":"0421735ab1c059c6","type":"text","text":"U-Boot SPL 2022.10-00002-gcadb0cd1 (Jan 10 2025 - 06:11:11 +0000)\n00000000: PMU Major Msg: End of CA training                                            \n00000000: PMU Major Msg: End of initialization                                         \n00000000: PMU Major Msg: End of read enable training                                   \n00000000: PMU Major Msg: End of fine write leveling                                    \n00000000: PMU Major Msg: End of read dq deskew training                                \n00000000: PMU Major Msg: End of MPR read delay center optimization                     \n00000000: PMU Major Msg: End of Write leveling coarse delay                            \n00000000: PMU Major Msg: End of write delay center optimization                        \n00000000: PMU Major Msg: End of read delay center optimization                         \n00000000: PMU Major Msg: End of max read latency training                              \n00000000: PMU Major Msg: Firmware run has completed              \n                      \nimage: uboot load to 1000000 compress =1 src 2aaaacff len=49cd3 \n\n\nU-Boot 2022.10-00002-gcadb0cd1 (Jan 10 2025 - 06:11:11 +0000)\n\nCPU:   rv64imafdcvsu\nModel: kendryte k230 canmv lckfb\nDRAM:  1 GiB\nCore:  26 devices, 13 uclasses, devicetree: embed\nMMC:   mmc0@91580000: 0, mmc1@91581000: 1\nLoading Environment from MMC... \nOK\nIn:    serial@91400000\nOut:   serial@91400000\nErr:   serial@91400000\nNet:   No ethernet found.\nHit any key to stop autoboot:  0 \nimage: rtt load to 0 compress =1 src 2aaaad07 len=188493 \nJump to big hart\n\nOpenSBI v1.2.2\nheap: [0x004c95c0 - 0x044c95c0], size 65536 KB\npage: [0x044c95c8 - 0x1fffec00], size 453845 KB\nlwIP-2.1.2 initialized!\nCan't find sensor on csi0\n[I/SDIO] SD cCan't find sensor on csi1\na find sensor on csi1\n","x":780,"y":1500,"width":422,"height":236},
		{"id":"6ddda4e1146ff11b","type":"text","text":"UART0 可以进去查看，有mpy，大核占用为`FinSH`控制台串口，只有输出无输入；UART3串口无响应，无占用","x":860,"y":1307,"width":246,"height":113},
		{"id":"cb60137d761c7960","type":"text","text":"[自定义固件 ](https://github.com/kendryte/canmv_k230/blob/main/BUILD.md)最新版","x":1020,"y":1854,"width":250,"height":60},
		{"id":"ebfcdead9bed787b","type":"file","file":"010-实践/AGI Car/编译庐山派K230 canmv固件方法.md","x":945,"y":2080,"width":400,"height":400},
		{"id":"119954a86378fddc","type":"text","text":"CONFIG_RT_LWIP_TCP_SEG_NUM=256\n\n最新的canmv_k230库编译，要把上面的这个值从76改成比176大的值，否则编译会报错","x":984,"y":2557,"width":322,"height":220},
		{"id":"2276550cc8c6ccd7","type":"text","text":"最新的库已经修复？","x":1027,"y":2836,"width":250,"height":60},
		{"id":"6ffc82d7a491e83b","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250212113119.png","x":-999,"y":1760,"width":836,"height":440},
		{"id":"d9a7491757b9cb7a","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250212113221.png","x":-1840,"y":1340,"width":720,"height":584},
		{"id":"764666cd7ac06eb1","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250212113418.png","x":-1865,"y":2049,"width":783,"height":497},
		{"id":"2ade730ba7515b7c","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250212113537.png","x":-1913,"y":2580,"width":880,"height":622},
		{"id":"d87e176a02c60835","type":"text","text":"记忆中 认知系统中","x":1747,"y":1648,"width":250,"height":60},
		{"id":"fbcd196e7ccb63dd","type":"text","text":"物理层","x":1759,"y":1533,"width":250,"height":60},
		{"id":"699ff8c1d494d028","type":"text","text":"","x":1340,"y":1588,"width":250,"height":60},
		{"id":"beb5b5166c2013d6","type":"text","text":"K230支持5路UART信号，其具有以下特点：\n\n支持2线UART和4线UART\n支持RS485接口\n支持**波特率**最高可达**3.125M**\n支持**软硬件流控**，符合16750标准\n- Transmit and receive **FIFO** depths of 32, Supports **32x32-bit** transmit first-in, first-out (FIFO) and 32x32-bit RX FIFO, Internal FIFO (RAM)\n支持IrDA 1.0 SIR接收","x":1550,"y":1072,"width":447,"height":388},
		{"id":"eb86f9040aee2805","type":"text","text":"支持I2C速率最高到3.4Mbit/s\n\n- Three speeds:\n    - Standard mode (0 to 100 Kb/s)\n    - Fast mode (≤400 Kb/s) or **fast mode plus** (≤1000 Κb/s)\n    - **High-speed mode** (≤3.4 Mb/s)\n      \n    - **32x32** bits TX FIFOs and **64x8** bits RX FIFOs","x":1155,"y":1060,"width":370,"height":210},
		{"id":"e1c60b297d6a8d8e","type":"text","text":"Linux+RT Smart 双系统配置\n\n1. Wi-Fi没有RTL8189驱动\n2. 内存布局不同\n\n![image.png](http://qingniu.oos.hailay.site/202502132129119.png)\n\n","x":647,"y":3964,"width":793,"height":516},
		{"id":"e8bf92052fbd6085","type":"file","file":"99-Meta/附件存储/appendix/5c55462a398d5faf2c199c1ac061439.png","x":1620,"y":4141,"width":541,"height":279},
		{"id":"6c01027d71a0c276","type":"link","url":"https://developer.canaan-creative.com/k230/dev/02_applications/tutorials/K230_%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96%E6%8C%87%E5%8D%97.html","x":1620,"y":3640,"width":400,"height":400},
		{"id":"5c73de31937e83db","type":"text","text":"## 纯Linux WiFi 间隔5分钟断连问题\n\n查看状态\n```\nsystemctl status NetworkManager\n```\n\n## 解决\n1. 使用单一的dhcp命令，不重复获取新IP\n2. 使用`wpa_supplicant`配置文件固定SSID和密码psk\n\n\nWi-Fi 连接命令\n```\nifconfig wlan0 up\n\nwpa_supplicant -D nl80211 -i wlan0 -c /etc/wpa_supplicant.conf &\n\ndhclient\n```","x":1023,"y":4799,"width":697,"height":461},
		{"id":"001b747fc8782ea2","type":"text","text":"bootloader\n引导加载器","x":560,"y":5930,"width":250,"height":60,"color":"1"},
		{"id":"8864e5df02c7173f","type":"text","text":"kernel\n内核","x":980,"y":5930,"width":250,"height":60,"color":"1"},
		{"id":"b3d1a3601ce7c47a","type":"text","text":"U-Boot","x":560,"y":6070,"width":250,"height":60},
		{"id":"c42f65763187a193","type":"text","text":"rootfs\n根文件系统","x":1492,"y":5930,"width":250,"height":60,"color":"1"},
		{"id":"de23d0d034b5c6fa","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250215151245.png","x":1417,"y":6100,"width":400,"height":170},
		{"id":"335eaff7ee9ba542","type":"text","text":"设备树","x":777,"y":5790,"width":250,"height":60,"color":"1"},
		{"id":"d3797040bbb5d816","type":"file","file":"99-Meta/附件存储/appendix/Pasted image 20250215151434.png","x":705,"y":5670,"width":398,"height":75},
		{"id":"6df0eb2ee5787819","type":"text","text":"## 制作根文件系统 Ubuntu\n\n使用方案：\nhttps://developer.canaan-creative.com/k230_linux/dev/zh/01_software/K230_debian_ubuntu%E7%AD%89%E5%8F%91%E8%A1%8C%E7%89%88%E8%AF%B4%E6%98%8E.html#ubuntu\n\n```bash\nyou need manually execute the follow commands\n\n#docker run  --privileged  -u root -it  -v $(pwd):$(pwd)    -w $(pwd) ubuntu24:v1  /bin/bash\n\nrm -rf ubuntu24\nsudo debootstrap --arch=riscv64   noble ubuntu24 https://mirrors.aliyun.com/ubuntu-ports/\nchroot ubuntu24 /bin/bash\n\ncat >/etc/apt/sources.list <<EOF\ndeb https://mirrors.aliyun.com/ubuntu-ports noble main restricted\n\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-updates main restricted\n\ndeb https://mirrors.aliyun.com/ubuntu-ports noble universe\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-updates universe\n\ndeb https://mirrors.aliyun.com/ubuntu-ports noble multiverse\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-updates multiverse\n\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-backports main restricted universe multiverse\n\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-security main restricted\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-security universe\ndeb https://mirrors.aliyun.com/ubuntu-ports noble-security multiverse\nEOF\necho \"root:root\" | chpasswd\necho k230>/etc/hostname\napt-get install ssh  parted\necho \"PermitRootLogin yes\" >> /etc/ssh/sshd_config\necho \"a\" >/first_boot_flag\ncat << 'EOF' > /etc/profile.d/disk.sh\nif [ -f /first_boot_flag ]; then\n    echo \"first boot flag\"\n    sd_size=$(parted /dev/mmcblk0 print | grep mmcblk0 | cut -d: -f2)\n    parted /dev/mmcblk0 resizepart 2 ${sd_size}; resize2fs /dev/mmcblk0p2\n    rm -rf /first_boot_flag\nelse\n    echo \"not exit flag\"\nfi\nEOF\n\nexit\nsudo tar -czf ubuntu24.tar.gz ubuntu24\n# debian13_size=\"$(( \"$(sudo du -sm ubuntu24 | cut -f1 )\" + 300 ))\"\n# mkfs.ext4  -d ubuntu24  -r 1 -N 0 -m 1 -L \"rootfs\" -O ^64bit ubuntu24.ext4 ${debian13_size}m\n# tar -czvf ubuntu24.ext4.tar.gz ubuntu24.ext4\n\n\nYou need to manually execute the above commands one by one on linux(not docker)\nreferenc doc is <<https://developer.canaan-creative.com/k230/zh/dev/03_other/K230_debian_ubuntu%E8%AF%B4%E6%98%8E.html>>\n```\n\n目标：更新rootfs（根文件目录，即设备树DF）\n- 采取方法：执行以上代码块中的命令\n\n### 第二步：debootstrap\n\n目标：执行以下命令（上述命令中的第二条）\n```bash\nsudo debootstrap --arch=riscv64   noble ubuntu24 https://mirrors.aliyun.com/ubuntu-ports/\n```\n\n#### 坑：提取包失败\n```\nTried to extract package, but file already exists. Exit...\n```\n\n解决：下载最新的`debootstrap`\n```\nwget https://archive.ubuntu.com/ubuntu/pool/main/d/debootstrap/debootstrap_1.0.140_all.deb\n```\n\n#### 坑@16点00分：qemu依赖\n```\nchroot: failed to run command ‘/bin/bash’: Exec format error\n```\n\n解决：需要安装依赖\n```\nsudo apt install qemu-user-static binfmt-support debootstrap debian-ports-archive-keyring systemd-container rsync wget\n```\n\n#### 坑@16点17分：systemd\n```\nW: Failure trying to run: chroot \"/home/starlin/k230_linux_sdk/output/k230_canmv_lckfb_defconfig/images/ubuntu24\" dpkg --force-overwrite --force-confold --skip-same-version --install /var/cache/apt/archives/libapparmor1_4.0.0-beta3-0ubuntu3_riscv64.deb /var/cache/apt/archives/libargon2-1_0~20190702+dfsg-4build1_riscv64.deb /var/cache/apt/archives/libcryptsetup12_2%3a2.7.0-1ubuntu4_riscv64.deb /var/cache/apt/archives/libdevmapper1.02.1_2%3a1.02.185-3ubuntu3_riscv64.deb /var/cache/apt/archives/libfdisk1_2.39.3-9ubuntu6_riscv64.deb /var/cache/apt/archives/libjson-c5_0.17-1build1_riscv64.deb /var/cache/apt/archives/libkmod2_31+20240202-2ubuntu7_riscv64.deb /var/cache/apt/archives/libseccomp2_2.5.5-1ubuntu3_riscv64.deb /var/cache/apt/archives/libsystemd-shared_255.4-1ubuntu8_riscv64.deb /var/cache/apt/archives/systemd_255.4-1ubuntu8_riscv64.deb /var/cache/apt/archives/systemd-dev_255.4-1ubuntu8_all.deb\nW: See /home/starlin/k230_linux_sdk/output/k230_canmv_lckfb_defconfig/images/ubuntu24/debootstrap/debootstrap.log for details (possibly the package systemd is at fault)\n```\n\n日志@`debootstrap.log`（最后几行）\n```\nUnpacking systemd (255.4-1ubuntu8) ...\nPreparing to unpack .../systemd-dev_255.4-1ubuntu8_all.deb ...\nUnpacking systemd-dev (255.4-1ubuntu8) ...\nSetting up libapparmor1:riscv64 (4.0.0-beta3-0ubuntu3) ...\nSetting up libargon2-1:riscv64 (0~20190702+dfsg-4build1) ...\nSetting up libdevmapper1.02.1:riscv64 (2:1.02.185-3ubuntu3) ...\nSetting up libfdisk1:riscv64 (2.39.3-9ubuntu6) ...\nSetting up libjson-c5:riscv64 (0.17-1build1) ...\nSetting up libkmod2:riscv64 (31+20240202-2ubuntu7) ...\nSetting up libseccomp2:riscv64 (2.5.5-1ubuntu3) ...\nSetting up libsystemd-shared:riscv64 (255.4-1ubuntu8) ...\nSetting up systemd-dev (255.4-1ubuntu8) ...\nSetting up libcryptsetup12:riscv64 (2:2.7.0-1ubuntu4) ...\nSetting up systemd (255.4-1ubuntu8) ...\nCreated symlink /etc/systemd/system/getty.target.wants/getty@tty1.service -> /usr/lib/systemd/system/getty@.service.\nCreated symlink /etc/systemd/system/multi-user.target.wants/remote-fs.target -> /usr/lib/systemd/system/remote-fs.target.\nCreated symlink /etc/systemd/system/sysinit.target.wants/systemd-pstore.service -> /usr/lib/systemd/system/systemd-pstore.service.\nInitializing machine ID from random generator.\n/usr/lib/tmpfiles.d/systemd-network.conf:10: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd-network.conf:11: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd-network.conf:12: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd-network.conf:13: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd.conf:22: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:23: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:28: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:29: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:30: Failed to resolve group 'systemd-journal': No such process\nFailed to take /etc/passwd lock: Invalid argument\ndpkg: error processing package systemd (--install):\n installed systemd package post-installation script subprocess returned error exit status 1\nProcessing triggers for libc-bin (2.39-0ubuntu8) ...\nErrors were encountered while processing:\n systemd\n```\n\n分析 from DeepSeek：chroot内的系统环境问题\n\n```bash\n# 创建专用构建容器\ndocker run --privileged --name k230-builder \\\n  -v $(pwd):/build \\\n  -w /build \\\n  ubuntu:24.04\n\n# 在容器内执行\napt update && apt install -y debootstrap qemu-user-static\ndebootstrap --arch=riscv64 --foreign noble ubuntu24\ncp /usr/bin/qemu-riscv64-static ubuntu24/usr/bin/\nchroot ubuntu24 /debootstrap/debootstrap --second-stage\n```\n（和最初需要运行的命令对比：\n```bash\nsudo debootstrap --arch=riscv64   noble ubuntu24 https://mirrors.aliyun.com/ubuntu-ports/\n```\n）\n\n16点52分 尝试解决方法：切换环境→docker\n\n创建虚拟环境：\n```bash\ndocker run  --privileged  -u root -it  -v $(pwd):$(pwd)    -w $(pwd) ubuntu:24.04  /bin/bash\n```\n执行结果：进入虚拟环境\n```bash\nstarlin@StarCloud:~/k230_linux_sdk/output/k230_canmv_lckfb_defconfig/images$ sudo docker run  --privile\nged  -u root -it  -v $(pwd):$(pwd)    -w $(pwd) ubuntu:24.04  /bin/bash\nroot@fe2a06d222fa:/home/starlin/k230_linux_sdk/output/k230_canmv_lckfb_defconfig/images#\n```\ni 在虚拟环境中更新apt，同样遇到systemd警报\n```bash\napt update && apt install -y debootstrap qemu-user-static\n```\n→\n```bash\nSetting up systemd (255.4-1ubuntu8.5) ...\nCreated symlink /etc/systemd/system/getty.target.wants/getty@tty1.service → /usr/lib/systemd/system/getty@.service.\nCreated symlink /etc/systemd/system/multi-user.target.wants/remote-fs.target → /usr/lib/systemd/system/\nremote-fs.target.\nCreated symlink /etc/systemd/system/sysinit.target.wants/systemd-pstore.service → /usr/lib/systemd/syst\nem/systemd-pstore.service.\nInitializing machine ID from D-Bus machine ID.\n/usr/lib/tmpfiles.d/systemd-network.conf:10: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd-network.conf:11: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd-network.conf:12: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd-network.conf:13: Failed to resolve user 'systemd-network': No such process\n/usr/lib/tmpfiles.d/systemd.conf:22: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:23: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:28: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:29: Failed to resolve group 'systemd-journal': No such process\n/usr/lib/tmpfiles.d/systemd.conf:30: Failed to resolve group 'systemd-journal': No such process\nCreating group 'systemd-journal' with GID 999.\nCreating group 'systemd-network' with GID 998.\nCreating user 'systemd-network' (systemd Network Management) with UID 998 and GID 998.\n```\n\n执行第二条命令后：提取包报错\n```bash\nI: Extracting base-files...\nE: Tried to extract package, but tar failed. Exit...\n/usr/bin/cat: /debootstrap/mirror: No such file or directory\n```\n\n在应用qemu环境的解决方案之后：\n```\nI: Extracting base-files...\nE: Tried to extract package, but tar failed. Exit...\n```\n同样的问题，只少了最后一行\n","x":1476,"y":6386,"width":704,"height":694},
		{"id":"d4b61617e09db048","type":"link","url":"https://doc.embedfire.com/lubancat/build_and_deploy/zh/latest/building_image/image_composition/image_composition.html","x":-120,"y":6333,"width":400,"height":400}
	],
	"edges":[
		{"id":"4e126dbe2a067586","fromNode":"1ce272067a1852d1","fromSide":"left","toNode":"68ac3a73800fcc1f","toSide":"right","label":"150R 购买"},
		{"id":"7a51e843d3d5f139","fromNode":"5255259660570bc8","fromSide":"bottom","toNode":"254cd390f67dfb4f","toSide":"top"},
		{"id":"eff810b686b53b72","fromNode":"254cd390f67dfb4f","fromSide":"bottom","toNode":"9f81072edabab14d","toSide":"top"},
		{"id":"d12ada47cb623f4f","fromNode":"9f81072edabab14d","fromSide":"bottom","toNode":"294c184c4cc4b1fa","toSide":"top"},
		{"id":"714f2c97b49df653","fromNode":"5255259660570bc8","fromSide":"right","toNode":"96f761af5e879393","toSide":"left"},
		{"id":"f0a482bbbdd55e8b","fromNode":"96f761af5e879393","fromSide":"right","toNode":"eaea6a58bb73ece4","toSide":"left"},
		{"id":"679e0a4534c7bb2c","fromNode":"eaea6a58bb73ece4","fromSide":"right","toNode":"c66c924ac45724b7","toSide":"left"},
		{"id":"612225c3e7ca4d19","fromNode":"1ce272067a1852d1","fromSide":"right","toNode":"5255259660570bc8","toSide":"left"},
		{"id":"d92d3da714622081","fromNode":"96f761af5e879393","fromSide":"bottom","toNode":"4edcc122ec069de9","toSide":"top"},
		{"id":"9219a8b490bb6556","fromNode":"ee30dc310284920d","fromSide":"left","toNode":"e3dee4008797092d","toSide":"right"},
		{"id":"9040e4768a4f2a0d","fromNode":"4edcc122ec069de9","fromSide":"bottom","toNode":"d14563b3a4636ec1","toSide":"top"},
		{"id":"9b6184a3e4c6aaef","fromNode":"d14563b3a4636ec1","fromSide":"bottom","toNode":"b0bf1655232a923d","toSide":"top"},
		{"id":"2d6508d99028fb53","fromNode":"c66c924ac45724b7","fromSide":"bottom","toNode":"3186af67ed5d89f3","toSide":"top"},
		{"id":"638bd16af7319485","fromNode":"c66c924ac45724b7","fromSide":"bottom","toNode":"52c6a6565f647fa7","toSide":"top"},
		{"id":"46856032c6422819","fromNode":"c66c924ac45724b7","fromSide":"right","toNode":"e56cdf8fcd04ef2f","toSide":"left"},
		{"id":"c50917babaf25e90","fromNode":"ee30dc310284920d","fromSide":"bottom","toNode":"b3d8ffdb2b066cad","toSide":"right"},
		{"id":"3d280529a71d4942","fromNode":"c66c924ac45724b7","fromSide":"top","toNode":"e6c7322af0e108ce","toSide":"bottom"},
		{"id":"ee721b07858e4e7b","fromNode":"b0bf1655232a923d","fromSide":"bottom","toNode":"7a2f125fe4720aa9","toSide":"top"},
		{"id":"fc13ec6ba859e9f6","fromNode":"96f761af5e879393","fromSide":"top","toNode":"2090fb86a7d04361","toSide":"bottom"},
		{"id":"a3018bd317722be4","fromNode":"7a2f125fe4720aa9","fromSide":"right","toNode":"1e3124287a809dc4","toSide":"left","label":"RT-Smart单核系统"},
		{"id":"9bc374d097b0d884","fromNode":"96f761af5e879393","fromSide":"top","toNode":"223b7e9ddeb5cd15","toSide":"bottom"},
		{"id":"16848b9d56b9a47f","fromNode":"957c28c3f2df157e","fromSide":"bottom","toNode":"c9e78b813c3ae603","toSide":"top"},
		{"id":"4b1860bfa33e5811","fromNode":"3dc46e5f4e088811","fromSide":"left","toNode":"ae88f9b97b7137bb","toSide":"top"},
		{"id":"aa6155dc31d62cf5","fromNode":"3dc46e5f4e088811","fromSide":"right","toNode":"434f1ad1856d3e88","toSide":"top"},
		{"id":"4f9400705e73b775","fromNode":"993bf5ab54f62041","fromSide":"bottom","toNode":"13472bf27e21b30e","toSide":"top"},
		{"id":"27ea511bbfa41e60","fromNode":"dc63c095ded2423e","fromSide":"bottom","toNode":"1a509558926c7876","toSide":"top"},
		{"id":"410bd7a3bdfa46dd","fromNode":"aa26482d0a8d5761","fromSide":"right","toNode":"b8e73d75ba1dd1e4","toSide":"left"},
		{"id":"cffbdc93dfb40fbf","fromNode":"b8e73d75ba1dd1e4","fromSide":"bottom","toNode":"7ce747c1fb6fa5d6","toSide":"top"},
		{"id":"017a6e53446d2d9a","fromNode":"aa26482d0a8d5761","fromSide":"bottom","toNode":"191b78514af1385b","toSide":"top"},
		{"id":"d31cb03c43428fb9","fromNode":"aa26482d0a8d5761","fromSide":"top","toNode":"1304bd533742b211","toSide":"bottom"},
		{"id":"769c0134dd74dc8b","fromNode":"223b7e9ddeb5cd15","fromSide":"top","toNode":"2314fc00e5872dc8","toSide":"bottom"},
		{"id":"4df2a071540d1b6b","fromNode":"cee0f2f679d74b20","fromSide":"right","toNode":"6ddda4e1146ff11b","toSide":"left"},
		{"id":"d483d1b9fbf294c6","fromNode":"6ddda4e1146ff11b","fromSide":"bottom","toNode":"0421735ab1c059c6","toSide":"top","label":"UART0"},
		{"id":"b2f0abe02f155dde","fromNode":"0421735ab1c059c6","fromSide":"bottom","toNode":"cb60137d761c7960","toSide":"top"},
		{"id":"7a8c73e8b1a27947","fromNode":"cb60137d761c7960","fromSide":"bottom","toNode":"ebfcdead9bed787b","toSide":"top"},
		{"id":"9de434eb45a41cbb","fromNode":"ebfcdead9bed787b","fromSide":"bottom","toNode":"119954a86378fddc","toSide":"top"},
		{"id":"fc79c0d5467c8d23","fromNode":"eb86f9040aee2805","fromSide":"right","toNode":"beb5b5166c2013d6","toSide":"left"},
		{"id":"924819b9e18ce4f4","fromNode":"e1c60b297d6a8d8e","fromSide":"right","toNode":"e8bf92052fbd6085","toSide":"left"},
		{"id":"f3f828b8e3660736","fromNode":"8864e5df02c7173f","fromSide":"right","toNode":"c42f65763187a193","toSide":"left"},
		{"id":"97f7f7948f4f0496","fromNode":"001b747fc8782ea2","fromSide":"bottom","toNode":"b3d1a3601ce7c47a","toSide":"top"},
		{"id":"9de820fc24a4ad5f","fromNode":"c42f65763187a193","fromSide":"bottom","toNode":"de23d0d034b5c6fa","toSide":"top"},
		{"id":"3ae31d54ed9c86a3","fromNode":"001b747fc8782ea2","fromSide":"right","toNode":"335eaff7ee9ba542","toSide":"bottom"},
		{"id":"388de224bdc37ced","fromNode":"335eaff7ee9ba542","fromSide":"bottom","toNode":"8864e5df02c7173f","toSide":"left"}
	]
}