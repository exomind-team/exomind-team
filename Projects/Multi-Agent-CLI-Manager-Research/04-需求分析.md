# Multi-Agent CLI Manager 需求分析

> 文档版本：v1.0
> 创建日期：2026年1月9日

## 一、需求来源

### 1.1 用户原始需求

根据用户描述，核心需求如下：

> 我需要不同的窗口进行不同的命令，就是不同的任务主题。我需要每一个窗口有标题，显示当前任务信息。任务进行到哪一步需要有提示，任务完成时需要有提示音。

### 1.2 需求拆解

| 原始需求 | 拆解后的具体需求 |
|---------|-----------------|
| 不同窗口进行不同任务 | 多窗口/多终端管理能力 |
| 每个窗口有标题 | 窗口标题自定义和任务信息显示 |
| 显示当前任务信息 | 实时任务状态和进度展示 |
| 任务进行到哪一步有提示 | 进度状态可视化 |
| 任务完成时有提示音 | 通知和提醒机制 |

## 二、核心需求定义

### 2.1 多窗口管理需求

#### 2.1.1 需求描述

用户需要能够同时管理多个独立的命令行窗口，每个窗口运行不同的 Agent 或执行不同的任务主题。

#### 2.1.2 详细需求

| 编号 | 需求描述 | 优先级 | 说明 |
|-----|---------|--------|------|
| R-MW-001 | 支持创建多个独立窗口 | P0 | 每个窗口独立运行，互不干扰 |
| R-MW-002 | 支持窗口命名和标识 | P0 | 每个窗口可以设置标题和标签 |
| R-MW-003 | 支持窗口布局管理 | P1 | 平铺、堆叠、全屏等布局 |
| R-MW-004 | 支持窗口快速切换 | P1 | 快捷键或鼠标快速切换 |
| R-MW-005 | 支持窗口状态保存 | P2 | 恢复窗口会话状态 |

#### 2.1.3 实现方案对比

| 方案 | 描述 | 优点 | 缺点 | 适用性 |
|-----|------|-----|------|--------|
| 终端多路复用器 | tmux、screen | 功能强大、稳定 | 配置复杂、界面朴素 | ⭐⭐⭐ |
| 虚拟终端库 | xterm.js、iTerm2 | 可定制性强 | 开发成本高 | ⭐⭐ |
| 现有管理工具 | Vibe Kanban | 功能完整、即用 | 需学习新工具 | ⭐⭐⭐⭐⭐ |
| 自定义桌面应用 | Tauri/Electron | 完全定制 | 开发周期长 | ⭐⭐⭐ |

### 2.2 窗口标题与任务信息显示需求

#### 2.2.1 需求描述

每个窗口需要清晰显示当前任务的标题、状态和关键信息，使用户能够快速识别窗口内容。

#### 2.2.2 详细需求

| 编号 | 需求描述 | 优先级 | 说明 |
|-----|---------|--------|------|
| R-TI-001 | 支持自定义窗口标题 | P0 | 允许用户设置有意义的标题 |
| R-TI-002 | 显示当前 Agent 类型 | P0 | 如 Claude Code、Gemini CLI |
| R-TI-003 | 显示任务状态 | P0 | 运行中、已完成、错误等 |
| R-TI-004 | 显示进度百分比 | P1 | 估算任务完成进度 |
| R-TI-005 | 显示任务开始时间 | P2 | 记录任务持续时间 |
| R-TI-006 | 显示输出摘要 | P2 | 最近输出的简短摘要 |

#### 2.2.3 标题格式建议

```
[Agent类型] [任务名称] - [状态] - [进度]
示例：
[Claude Code] 市场调研 - 运行中 - 35%
[Gemini CLI] 代码审查 - 等待输入 - 0%
[OpenSpec] 规格编写 - 已完成 - 100%
```

### 2.3 进度状态可视化需求

#### 2.3.1 需求描述

用户需要能够直观地了解每个任务的执行进度，包括当前阶段、完成百分比和预计剩余时间。

#### 2.3.2 详细需求

| 编号 | 需求描述 | 优先级 | 说明 |
|-----|---------|--------|------|
| R-PS-001 | 实时进度更新 | P0 | 状态变化时立即更新 |
| R-PS-002 | 进度百分比显示 | P0 | 量化进度指标 |
| R-PS-003 | 阶段状态标识 | P0 | 标识当前所处阶段 |
| R-PS-004 | 进度可视化图表 | P1 | 进度条、图表等形式 |
| R-PS-005 | 预计剩余时间 | P2 | 基于历史的估算 |
| R-PS-006 | 历史完成记录 | P2 | 记录历史任务耗时 |

#### 2.3.3 进度状态定义

| 状态 | 描述 | 颜色建议 |
|-----|------|---------|
| 等待中 | 任务已创建，等待执行 | 灰色 |
| 运行中 | 任务正在执行 | 蓝色/绿色 |
| 等待输入 | 需人工确认或输入 | 黄色 |
| 完成 | 任务已成功完成 | 绿色 |
| 错误 | 任务执行出错 | 红色 |
| 已取消 | 任务被手动取消 | 灰色 |

### 2.4 通知与提示音需求

#### 2.4.1 需求描述

任务状态变化时需要提供及时的通知，包括声音提示和视觉提示。

#### 2.4.2 详细需求

| 编号 | 需求描述 | 优先级 | 说明 |
|-----|---------|--------|------|
| R-NT-001 | 任务完成提示音 | P0 | 成功完成时播放 |
| R-NT-002 | 任务错误提示音 | P0 | 出错时播放 |
| R-NT-003 | 需要输入时提示 | P1 | 等待输入时提醒 |
| R-NT-004 | 系统通知集成 | P1 | 使用系统通知 API |
| R-NT-005 | 通知历史记录 | P2 | 保存历史通知 |
| R-NT-006 | 通知免打扰模式 | P2 | 临时关闭通知 |

#### 2.4.3 通知类型定义

| 事件类型 | 提示音 | 系统通知 | 说明 |
|---------|-------|---------|------|
| 任务开始 | 短促 | 可选 | 开始执行 |
| 任务完成 | 成功音 | 是 | 成功完成 |
| 任务错误 | 错误音 | 是 | 执行失败 |
| 需要输入 | 提示音 | 是 | 等待用户操作 |
| 进度里程碑 | 静音 | 可选 | 达到特定进度 |
| 长时间运行 | 静音 | 可选 | 运行超过阈值 |

## 三、功能需求汇总

### 3.1 需求优先级矩阵

| 优先级 | 需求编号 | 需求名称 | 需求类型 |
|--------|---------|---------|---------|
| P0 | R-MW-001 | 支持创建多个独立窗口 | 功能 |
| P0 | R-MW-002 | 支持窗口命名和标识 | 功能 |
| P0 | R-TI-001 | 支持自定义窗口标题 | 功能 |
| P0 | R-TI-002 | 显示当前 Agent 类型 | 功能 |
| P0 | R-TI-003 | 显示任务状态 | 功能 |
| P0 | R-PS-001 | 实时进度更新 | 功能 |
| P0 | R-PS-002 | 进度百分比显示 | 功能 |
| P0 | R-PS-003 | 阶段状态标识 | 功能 |
| P0 | R-NT-001 | 任务完成提示音 | 功能 |
| P0 | R-NT-002 | 任务错误提示音 | 功能 |
| P1 | R-MW-003 | 支持窗口布局管理 | 功能 |
| P1 | R-MW-004 | 支持窗口快速切换 | 功能 |
| P1 | R-TI-004 | 显示进度百分比 | 功能 |
| P1 | R-NT-003 | 需要输入时提示 | 功能 |
| P1 | R-NT-004 | 系统通知集成 | 功能 |
| P2 | R-MW-005 | 支持窗口状态保存 | 功能 |
| P2 | R-TI-005 | 显示任务开始时间 | 功能 |
| P2 | R-TI-006 | 显示输出摘要 | 功能 |
| P2 | R-PS-004 | 进度可视化图表 | 功能 |
| P2 | R-PS-005 | 预计剩余时间 | 功能 |
| P2 | R-PS-006 | 历史完成记录 | 功能 |
| P2 | R-NT-005 | 通知历史记录 | 功能 |
| P2 | R-NT-006 | 通知免打扰模式 | 功能 |

### 3.2 需求与现有工具匹配度

| 需求 | Vibe Kanban | Aviator | OpenSpec | Claude Code | 自建系统 |
|-----|-------------|---------|----------|-------------|---------|
| R-MW-001 | ✅ | ✅ | ❌ | ❌ | ✅ |
| R-MW-002 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-MW-003 | ✅ | ✅ | ❌ | ❌ | ✅ |
| R-MW-004 | ✅ | ✅ | ❌ | ❌ | ✅ |
| R-MW-005 | ❌ | ✅ | ❌ | ❌ | ✅ |
| R-TI-001 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-TI-002 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-TI-003 | ✅ | ✅ | ⚠️ | ⚠️ | ✅ |
| R-TI-004 | ✅ | ✅ | ❌ | ❌ | ✅ |
| R-TI-005 | ❌ | ✅ | ❌ | ❌ | ✅ |
| R-TI-006 | ❌ | ✅ | ❌ | ❌ | ✅ |
| R-PS-001 | ✅ | ✅ | ⚠️ | ⚠️ | ✅ |
| R-PS-002 | ✅ | ✅ | ❌ | ❌ | ✅ |
| R-PS-003 | ✅ | ✅ | ⚠️ | ⚠️ | ✅ |
| R-PS-004 | ✅ | ✅ | ❌ | ❌ | ✅ |
| R-PS-005 | ❌ | ✅ | ❌ | ❌ | ✅ |
| R-PS-006 | ❌ | ✅ | ❌ | ❌ | ✅ |
| R-NT-001 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-NT-002 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-NT-003 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-NT-004 | ✅ | ✅ | ❌ | ⚠️ | ✅ |
| R-NT-005 | ❌ | ✅ | ❌ | ❌ | ✅ |
| R-NT-006 | ❌ | ✅ | ❌ | ⚠️ | ✅ |

**匹配度说明**：
- ✅ 完全满足
- ⚠️ 部分满足（需要额外配置或脚本）
- ❌ 不满足

## 四、非功能需求

### 4.1 性能需求

| 编号 | 需求描述 | 目标值 |
|-----|---------|--------|
| NFP-001 | 窗口创建时间 | < 1秒 |
| NFP-002 | 状态更新延迟 | < 500ms |
| NFP-003 | 内存占用 | < 100MB |
| NFP-004 | CPU 占用 | < 5%（空闲时） |

### 4.2 可靠性需求

| 编号 | 需求描述 | 目标值 |
|-----|---------|--------|
| NFR-001 | 系统可用性 | 99.5% |
| NFR-002 | 数据持久化 | 任务状态不丢失 |
| NFR-003 | 错误恢复 | 崩溃后能恢复窗口状态 |

### 4.3 兼容性需求

| 编号 | 需求描述 |
|-----|---------|
| NFC-001 | Windows 10+ |
| NFC-002 | macOS 11+ |
| NFC-003 | Ubuntu 20.04+ |
| NFC-004 | 支持主流 Agent CLI |

### 4.4 安全需求

| 编号 | 需求描述 |
|-----|---------|
| NFS-001 | Agent 输出内容本地存储 |
| NFS-002 | API Key 本地加密存储 |
| NFS-003 | 窗口内容隔离 |

## 五、使用场景分析

### 5.1 场景一：并行研究任务

**场景描述**：
用户需要同时运行三个研究任务：
1. 市场调研（Claude Code）
2. 技术分析（Gemini CLI）
3. 竞品研究（OpenSpec）

**需求满足情况**：

| 需求 | 满足方式 |
|-----|---------|
| 多窗口管理 | Vibe Kanban 看板视图 |
| 窗口标题 | 每个卡片显示 Agent 和任务名称 |
| 进度跟踪 | 看板状态迁移显示进度 |
| 提示音 | 任务完成时播放成功音 |

### 5.2 场景二：规格驱动开发

**场景描述**：
用户使用 OpenSpec 进行规格驱动开发，同时运行编码 Agent 实施规格。

**需求满足情况**：

| 需求 | 满足方式 |
|-----|---------|
| 规格窗口 | 独立窗口显示 specs/changes |
| 编码窗口 | 运行 Claude Code CLI |
| 进度同步 | 状态更新同步到看板 |
| 完成通知 | 编码完成时通知 |

### 5.3 场景三：代码审查流程

**场景描述**：
Agent 生成代码后需要人工审查，审查通过后再合并。

**需求满足情况**：

| 需求 | 满足方式 |
|-----|---------|
| 生成窗口 | Agent 运行窗口 |
| 审查窗口 | 差异对比工具 |
| 状态切换 | 看板状态迁移 |
| 审查通知 | 系统通知提醒 |

## 六、需求实现建议

### 6.1 推荐方案

根据需求分析，推荐以下实现方案：

#### 方案 A：使用 Vibe Kanban（推荐）

**理由**：
1. 开源免费，功能完整
2. 专门设计用于多 Agent 管理
3. 看板视图满足多窗口管理需求
4. 支持代码审查和进度跟踪

**需要补充**：
1. 配置提示音
2. 自定义窗口标题格式
3. 通知设置

#### 方案 B：Vibe Kanban + 自定义脚本

**理由**：
1. 保留 Vibe Kanban 的核心功能
2. 通过脚本增强提示音和通知
3. 灵活定制

**需要开发**：
1. 提示音播放脚本
2. 系统通知集成
3. 窗口标题动态更新脚本

#### 方案 C：完全自建系统

**理由**：
1. 完全满足所有需求
2. 深度定制，符合个人工作习惯
3. 可持续迭代优化

**开发成本**：
- 预估开发时间：2-4 周
- 技术栈：Tauri + React/Vue + Rust

### 6.2 方案对比

| 对比维度 | 方案 A（Vibe Kanban） | 方案 B（+脚本） | 方案 C（自建） |
|---------|---------------------|----------------|---------------|
| 开发成本 | 无 | 低（1周） | 高（2-4周） |
| 功能满足度 | 85% | 95% | 100% |
| 定制程度 | 中等 | 高 | 完全 |
| 维护成本 | 低 | 中等 | 高 |
| 学习成本 | 中等 | 中等 | 高 |
| 推荐指数 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |

### 6.3 推荐决策路径

```
开始
  ↓
是否有预算购买商业软件？
  ├─ 是 → 考虑 Aviator Runbooks
  ↓ 否
是否有开发能力？
  ├─ 是 → 是否需要完全定制？
  │   ├─ 是 → 方案 C：自建系统
  │   ↓ 否
  │   方案 B：Vibe Kanban + 脚本
  ↓ 否
方案 A：Vibe Kanban
  ↓
结束
```

## 七、附录

### 7.1 术语表

| 术语 | 定义 |
|-----|------|
| Agent | 智能代理程序 |
| CLI | 命令行界面 |
| MCP | Model Context Protocol |
| 看板 | 可视化任务管理工具 |
| Runbook | 自动化任务脚本 |

### 7.2 参考资料

- Vibe Kanban 官方文档
- OpenSpec 用户指南
- Claude Code 使用手册

---

**文档作者**：Claude Code
**文档版本**：v1.0
**最后更新**：2026年1月9日
